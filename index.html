<!DOCTYPE html>
<html>
<head>
  <title>Agenda Barbearia</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    select, button { margin: 10px 0; padding: 8px; font-size: 16px; }
  </style>
</head>
<body>
  <h2>üìÖ Agende um hor√°rio</h2>

  <label>M√™s:</label><br>
  <select id="mes"></select><br>

  <label>Dia:</label><br>
  <select id="dia"></select><br>

  <label>Barbeiro:</label><br>
  <select id="barbeiro">
    <option value="felipe">Felipe</option>
    <option value="moises">Mois√©s</option>
    <option value="jordan">Jordan</option>
  </select><br>

  <button onclick="buscarAgenda()">Ver hor√°rios</button>

  <pre id="resultado"></pre>

  <script>
    const mesSelect = document.getElementById('mes');
    const diaSelect = document.getElementById('dia');
    const resultado = document.getElementById('resultado');

    for (let i = 1; i <= 12; i++) {
      const opt = document.createElement('option');
      opt.value = i.toString().padStart(2, '0');
      opt.text = `${i} - ${new Date(0, i - 1).toLocaleString('pt-BR', { month: 'long' })}`;
      mesSelect.appendChild(opt);
    }

    for (let i = 1; i <= 31; i++) {
      const opt = document.createElement('option');
      opt.value = i.toString().padStart(2, '0');
      opt.text = i;
      diaSelect.appendChild(opt);
    }

    function buscarAgenda() {
      const barbeiro = document.getElementById('barbeiro').value;
      const mes = mesSelect.value;
      const dia = diaSelect.value;
      const ano = new Date().getFullYear();
      const data = `${ano}-${mes}-${dia}`;

      fetch(`/proxy?barbeiro=${barbeiro}&data=${data}`)
        .then(res => res.json())
        .then(json => {
          if (json.erro) {
            resultado.textContent = '‚ùå ' + json.erro;
          } else if (json.horarios.length === 0) {
            resultado.textContent = `‚ö†Ô∏è Nenhum hor√°rio dispon√≠vel para ${json.data}`;
          } else {
            resultado.textContent = `üìÖ Hor√°rios de ${json.barbeiro} em ${json.data}:\n\n` + json.horarios.join('\n');
          }
        })
        .catch(() => resultado.textContent = '‚ùå Erro ao consultar servidor.');
    }
  </script>
</body>
</html>
